From 6914038aa460f27fcbde153b083da7174c59522d Mon Sep 17 00:00:00 2001
From: Andrea Righi <andrea.righi@canonical.com>
Date: Tue, 3 Jan 2023 17:42:09 +0100
Subject: [PATCH 36/36] UBUNTU: SAUCE: Revert "apparmor: make __aa_path_perm()
 static"

This reverts commit 65f7f666f21ce374628d58b3cc48515070f31e72.

Signed-off-by: Andrea Righi <andrea.righi@canonical.com>
---
 security/apparmor/file.c         | 7 +++----
 security/apparmor/include/file.h | 3 +++
 2 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/security/apparmor/file.c b/security/apparmor/file.c
index c618e5ef0e58..68a8fad9e278 100644
--- a/security/apparmor/file.c
+++ b/security/apparmor/file.c
@@ -208,10 +208,9 @@ aa_state_t aa_str_perms(struct aa_policydb *file_rules, aa_state_t start,
 	return state;
 }
 
-static int __aa_path_perm(const char *op, struct aa_profile *profile,
-			  const char *name, u32 request,
-			  struct path_cond *cond, int flags,
-			  struct aa_perms *perms)
+int __aa_path_perm(const char *op, struct aa_profile *profile, const char *name,
+		   u32 request, struct path_cond *cond, int flags,
+		   struct aa_perms *perms)
 {
 	struct aa_ruleset *rules = list_first_entry(&profile->rules,
 						    typeof(*rules), list);
diff --git a/security/apparmor/include/file.h b/security/apparmor/include/file.h
index 5be620af33ba..1a1c0f0c5071 100644
--- a/security/apparmor/include/file.h
+++ b/security/apparmor/include/file.h
@@ -119,6 +119,9 @@ aa_state_t aa_str_perms(struct aa_policydb *file_rules, aa_state_t start,
 			const char *name, struct path_cond *cond,
 			struct aa_perms *perms);
 
+int __aa_path_perm(const char *op, struct aa_profile *profile,
+		   const char *name, u32 request, struct path_cond *cond,
+		   int flags, struct aa_perms *perms);
 int aa_path_perm(const char *op, struct aa_label *label,
 		 const struct path *path, int flags, u32 request,
 		 struct path_cond *cond);
-- 
2.40.1

